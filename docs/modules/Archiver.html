<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Archiver | Leviathan Helpers</title>
	<meta name="description" content="Documentation for Leviathan Helpers">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../assets/css/main.css">
	<script async src="../assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../assets/js/search.json" data-base="..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../index.html" class="title">Leviathan Helpers</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../modules.html">Leviathan Helpers</a>
				</li>
				<li>
					<a href="Archiver.html">Archiver</a>
				</li>
			</ul>
			<h1>Module Archiver</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<section class="tsd-panel tsd-comment">
				<div class="tsd-comment tsd-typography">
					<div class="lead">
						<a href="#send-reportsartifacts-from-testbot-back-to-client" id="send-reportsartifacts-from-testbot-back-to-client" style="color: inherit; text-decoration: none;">
							<h1>Send reports/artifacts from testbot back to client</h1>
						</a>
					</div>
					<p>By default, serial logs (given that the hardware is set up correctly), and the
						logs from the tests will be sent back to the client that started the test, upon
						the test finishing. Other artifacts can be sent back to the client using the
					<code>archiver</code> method.</p>
					<p>The Archiver is imported into each test and hence the methods can be accessed within any test. Check
					<code>test.js</code> to check the imports. To archive a file:</p>
					<dl class="tsd-comment-tags">
						<dt>example</dt>
						<dd><pre><code class="language-js"><span style="color: #002339">    </span><span style="color: #7B30D0">await</span><span style="color: #002339"> </span><span style="color: #000000">this</span><span style="color: #002339">.</span><span style="color: #2F86D2">Archiver</span><span style="color: #002339">.</span><span style="color: #7EB233">add</span><span style="color: #002339">(</span><span style="color: #000000">this</span><span style="color: #002339">.</span><span style="color: #2F86D2">id</span><span style="color: #002339">, </span><span style="color: #A44185">&quot;Path/to/file/needs/to/be/archived&quot;</span><span style="color: #002339">);</span>
</code></pre>
							<p>To directly archive the output of a command, example: <code>journalctl</code> or <code>dmesg</code> commands. Use the
							<code>archiveLogs</code> helper accessible through <code>worker</code> context.</p>
							<ul>
								<li>@example</li>
							</ul>
							<pre><code class="language-js"><span style="color: #002339">    </span><span style="color: #7B30D0">await</span><span style="color: #002339"> </span><span style="color: #000000">this</span><span style="color: #002339">.</span><span style="color: #2F86D2">context</span><span style="color: #002339">.</span><span style="color: #7EB233">get</span><span style="color: #002339">().</span><span style="color: #2F86D2">worker</span><span style="color: #002339">.</span><span style="color: #7EB233">archiveLogs</span><span style="color: #002339">(</span><span style="color: #2F86D2">title</span><span style="color: #002339">, </span><span style="color: #2F86D2">target</span><span style="color: #002339">, </span><span style="color: #2F86D2">command</span><span style="color: #002339">);</span>
</code></pre>
							<p>Using this method, at the end of the test, any artifacts added to the archive are compressed and
								downloaded by the client. These are available in the <code>workspace/reports</code> directory at the end of
							the test. This can also be helpful when storing artifacts/reports/logs after a test suite run.</p>
						</dd>
					</dl>
				</div>
			</section>
			<section class="tsd-panel-group tsd-index-group">
				<h2>Index</h2>
				<section class="tsd-panel tsd-index-panel">
					<div class="tsd-index-content">
						<section class="tsd-index-section ">
							<h3>Functions</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-function tsd-parent-kind-module"><a href="Archiver.html#add" class="tsd-kind-icon">add</a></li>
								<li class="tsd-kind-function tsd-parent-kind-module"><a href="Archiver.html#getStream" class="tsd-kind-icon">get<wbr>Stream</a></li>
							</ul>
						</section>
					</div>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group ">
				<h2>Functions</h2>
				<section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module">
					<a name="add" class="tsd-anchor"></a>
					<h3>add</h3>
					<ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module">
						<li class="tsd-signature tsd-kind-icon">add<span class="tsd-signature-symbol">(</span>id<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, artifactPath<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/balena-os/test-helpers/blob/2f64d74/lib/helpers/archiver.ts#L61">lib/helpers/archiver.ts:61</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Archive a file to be later sent to the client as an artifact.</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>id: <span class="tsd-signature-type">string</span></h5>
									<div class="tsd-comment tsd-typography">
										<p>The name of the directory in which logs will be archived. Usuallly this value is the name of the
										test suite (Available in the test using <code>this.id</code>)</p>
									</div>
								</li>
								<li>
									<h5>artifactPath: <span class="tsd-signature-type">string</span></h5>
									<div class="tsd-comment tsd-typography">
										<p>The absolute path of the file needed to be archived.</p>
									</div>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module">
					<a name="getStream" class="tsd-anchor"></a>
					<h3>get<wbr>Stream</h3>
					<ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module">
						<li class="tsd-signature tsd-kind-icon">get<wbr>Stream<span class="tsd-signature-symbol">(</span>id<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, artifactPath<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">WriteStream</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/balena-os/test-helpers/blob/2f64d74/lib/helpers/archiver.ts#L76">lib/helpers/archiver.ts:76</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Archive the file as a stream to be later sent to the client as an artifact.</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>id: <span class="tsd-signature-type">string</span></h5>
									<div class="tsd-comment tsd-typography">
										<p>The name of the directory in which logs will be archived. Usuallly this value is the name of the
										test suite (Available in the test using <code>this.id</code>)</p>
									</div>
								</li>
								<li>
									<h5>artifactPath: <span class="tsd-signature-type">string</span></h5>
									<div class="tsd-comment tsd-typography">
										<p>The absolute path of the file needed to be archived.</p>
									</div>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">WriteStream</span><span class="tsd-signature-symbol">&gt;</span></h4>
							<p>stream of the file</p>
						</li>
					</ul>
				</section>
			</section>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="../modules.html">Modules</a>
					</li>
					<li class="current tsd-kind-module">
						<a href="Archiver.html">Archiver</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="Leviathan_Utilities.html">Leviathan <wbr>Utilities</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="Leviathan_Worker_helpers.html">Leviathan <wbr>Worker helpers</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="Preload.html">Preload</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="Screen_Capture.html">Screen <wbr>Capture</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="balenaOS_helpers.html">balenaOS helpers</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="balenaSDK_helpers.html">balenaSDK helpers</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-function tsd-parent-kind-module">
						<a href="Archiver.html#add" class="tsd-kind-icon">add</a>
					</li>
					<li class=" tsd-kind-function tsd-parent-kind-module">
						<a href="Archiver.html#getStream" class="tsd-kind-icon">get<wbr>Stream</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../assets/js/main.js"></script>
</body>
</html>